openapi: "3.0.0"
info:
  description: >
    # Building Data Models
    
    This repository is going to be archived (Jan-2020) and subsequent works will be carried out
    in [Smart data models] (https://github.com/smart-data-models) repositories. Further questions 
    on migration. alberto.abella@fiware.org
    
    This folders contains a number of data models related to the modelling of
    Building and its management based on
    [GSMA](https://www.gsma.com/iot/iot-big-data/) activities. Compared to GSMA
    models, we introduced some changes and removed the `BuildingType` model.
    The following entity types are supported:
    
    -   `Building`: A Building is a human build structure where different activities
        occur related to living, working, healing and so on.
    -   `BuildingOperation`: It captures automated operations that may be ongoing
        within a building.
        
        
  x-description-es: >
    
    # Construyendo modelos de datos
    
    Este repositorio se archivará (enero de 2020) y los trabajos posteriores se llevarán a cabo
    en los repositorios [Modelos de datos inteligentes] (https://github.com/smart-data-models).
    Más preguntas sobre migración. alberto.abella@fiware.org
    
    Esta carpeta contiene varios modelos de datos relacionados con el modelado de
    Edificio y su gestión basada en
    [GSMA] (https://www.gsma.com/iot/iot-big-data/) actividades. En comparación con GSMA
    modelos, introdujimos algunos cambios y eliminamos el modelo `BuildingType`.
  version: "1.0.0"
  title: "Building"

tags:
- name: "smart cities"
  description: "Everything about your Smart cities"


paths:
  /nsgi-ld:
    get:
      responses:
        200:
          description: "Linked-data"
          content:
            application/ld+json:
              examples: 
                foo:
                  summary: A foo example
                  value: 

                    id: 'urn:ngsi-ld:Building:building-a85e3da145c1'
                    type: Building
                    modifiedAt: '2016-08-08T10:18:16Z'
                    createdAt: '2016-08-08T10:18:16Z'
                    category:
                      type: Property
                      value:
                        - office
                    floorsBelowGround:
                      type: Property
                      value: 0
                    description:
                      type: Property
                      value: Office block
                    floorsAboveGround:
                      type: Property
                      value: 7
                    occupier:
                      type: Relationship
                      object:
                        - 'urn:ngsi-ld:Person:9830f692-7677-11e6-838b-4f9fb3dc5a4f'
                    mapUrl:
                      type: Property
                      value: 'http://www.example.com'
                    source:
                      type: Property
                      value: 'http://www.example.com'
                    location:
                      type: GeoProperty
                      value:
                        type: Polygon
                        coordinates:
                          - - - 100
                              - 0
                            - - 101
                              - 0
                            - - 101
                              - 1
                            - - 100
                              - 1
                            - - 100
                              - 0
                    address:
                      type: Property
                      value:
                        addressLocality: London
                        postalCode: EC4N 8AF
                        streetAddress: 25 Walbrook
                        type: PostalAddress
                    owner:
                      type: Relationship
                      object:
                        - 'urn:ngsi-ld:Person:cdfd9cb8-ae2b-47cb-a43a-b9767ffd5c84'
                        - 'urn:ngsi-ld:Person:1be9cd61-ef59-421f-a326-4b6c84411ad4'
                    openingHours:
                      type: Property
                      value:
                        - 'Mo-Fr 10:00-19:00'
                        - 'Sa 10:00-22:00'
                        - 'Su 10:00-21:00'
                    dataProvider:
                      type: Property
                      value: OperatorA
                    containedInPlace:
                      type: Property
                      value:
                        type: Polygon
                        coordinates:
                          - - - 100
                              - 0
                            - - 101
                              - 0
                            - - 101
                              - 1
                            - - 100
                              - 1
                            - - 100
                              - 0
                    '@context':
                      - 'https://schema.lab.fiware.org/ld/context'
                      - 'https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context.jsonld'



  /nsgi-v2:
    get:
      responses:
        200:
          description: "Invalid input"
          content:
            application/json:
              examples: 
                normalized:
                  summary: Normalized example
                  value: 
                    id: building-a85e3da145c1
                    type: Building
                    category:
                      value:
                       - office
                    floorsBelowGround:
                      value: 0
                    description:
                      value: Office block
                    floorsAboveGround:
                      value: 7
                    occupier:
                      type: Relationship
                      value:
                        - 9830f692-7677-11e6-838b-4f9fb3dc5a4f
                    mapUrl:
                      type: URL
                      value: 'http://www.example.com'
                    dateCreated:
                      type: DateTime
                      value: '2016-08-08T10:18:16Z'
                    source:
                      value: 'http://www.example.com'
                    location:
                      type: 'geo:json'
                      value:
                        type: Polygon
                        coordinates:
                         - - - 100
                             - 0
                           - - 101
                             - 0
                           - - 101
                             - 1
                           - - 100
                             - 1
                           - - 100
                             - 0
                        address:
                          type: PostalAddress
                          value:
                             addressLocality: London
                             postalCode: EC4N 8AF
                             streetAddress: 25 Walbrook
                        owner:
                          type: Relationship
                          value:
                             - cdfd9cb8-ae2b-47cb-a43a-b9767ffd5c84
                             - 1be9cd61-ef59-421f-a326-4b6c84411ad4
                        openingHours:
                          value:
                             - 'Mo-Fr 10:00-19:00'
                             - 'Sa 10:00-22:00'
                             - 'Su 10:00-21:00'
                        dataProvider:
                          value: OperatorA
                        dateModified:
                           type: DateTime
                           value: '2016-08-08T10:18:16Z'
                        containedInPlace:
                           value:
                             type: Polygon
                             coordinates:
                               - - - 100
                                   - 0
                                 - - 101
                                   - 0
                                 - - 101
                                   - 1
                                 - - 100
                                   - 1
                                 - - 100
                                   - 0
                         
                  
                  
                  
                keyvalues:
                  summary: Key-Values Pairs
                  value: 
                   id: building-a85e3da145c1
                   type: Building
                   dateCreated: '2016-08-08T10:18:16Z'
                   dateModified: '2016-08-08T10:18:16Z'
                   source: 'http://www.example.com'
                   dataProvider: OperatorA
                   category:
                     - office
                   containedInPlace:
                     type: Polygon
                     coordinates:
                       - - - 100
                           - 0
                         - - 101
                           - 0
                         - - 101
                           - 1
                         - - 100
                           - 1
                         - - 100
                           - 0
                   location:
                     type: Polygon
                     coordinates:
                       - - - 100
                           - 0
                         - - 101
                           - 0
                         - - 101
                           - 1
                         - - 100
                           - 1
                         - - 100
                           - 0
                   address:
                     addressLocality: London
                     postalCode: EC4N 8AF
                     streetAddress: 25 Walbrook
                   owner:
                     - cdfd9cb8-ae2b-47cb-a43a-b9767ffd5c84
                     - 1be9cd61-ef59-421f-a326-4b6c84411ad4
                   occupier:
                     - 9830f692-7677-11e6-838b-4f9fb3dc5a4f
                   floorsAboveGround: 7
                   floorsBelowGround: 0
                   description: Office block
                   mapUrl: 'http://www.example.com'
                   openingHours:
                     - 'Mo-Fr 10:00-19:00'
                     - 'Sa 10:00-22:00'
                     - 'Su 10:00-21:00'
                 


    
components:
  schemas:
  
      
    Common: 
      type: object
      required:
        - id
        - type
      properties:
        id:
          type: "string"
          description: >
            URN holding the id of the attribute
            
        type:
          type: "string"
          description: >
            The entity type
            
        dateModified :
          x-attr-type: "Property"
          x-model: "https://schema.org/DateTime"
          x-auto-gen: true
          type: "string"
          format: "date-time"
          readOnly: true
          description: >
            Update timestamp of this entity.
            
        dateCreated :
          x-attr-type: "Property"
          x-model: "https://schema.org/DateTime"
          x-auto-gen: true
          type: "string"
          format: "date-time"
          readOnly: true
          description: >
            Entity's creation timestamp.
            
    Description:
      description: >
        A description of the item
      x-attr-type: "Property"
      x-model: "https://schema.org/Text"
      type: "string"
      externalDocs:
        url:  "http://purl.org/dc/elements/1.1/description"
        x-see-also: 
          - "https://schema.org/description"
          - "https://www.dublincore.org/specifications/dublin-core/dcmi-terms/#http://purl.org/dc/elements/1.1/description"
       
  
    Movable: 
      type: object
      properties:
        location:
          type: object
          description: The current location of the item
          required:
            - type
          externalDocs:
            url: http://geojson.org/geojson-spec.html#geometry-objects
          properties:
            type:
              type: string
              enum:
              - Point
              - LineString
              - Polygon
              - MultiPoint
              - MultiLineString
              - MultiPolygon
              description: the geometry type


    Geometry:
      x-attr-type: "GeoProperty"
      type: object
      description: GeoJSon geometry
      required:
        - type
      externalDocs:
        url: http://geojson.org/geojson-spec.html#geometry-objects
      properties:
        type:
          type: string
          enum:
          - Point
          - LineString
          - Polygon
          - MultiPoint
          - MultiLineString
          - MultiPolygon
          description: the geometry type
    
    Point2D:
      type: array
      maxItems: 2
      minItems: 2
      items:
        type: number
    
    
    Point:
      type: object
      description: GeoJSON Point
      externalDocs:
        url: http://geojson.org/geojson-spec.html#id2
      allOf:
        - $ref: "#/components/schemas/Geometry"
        - properties:
            coordinates:
              $ref: '#/components/schemas/Point2D'
      
    LineString:
      type: object
      description: GeoJSON LineString
      externalDocs:
        url: http://geojson.org/geojson-spec.html#id3
      allOf:
        - $ref: "#/components/schemas/Geometry"
        - properties:
            coordinates:
              type: array
              items:
                $ref: '#/components/schemas/Point2D'
  
    Polygon:
      type: object
      description: GeoJSON Polygon
      externalDocs:
        url: http://geojson.org/geojson-spec.html#id4
      allOf:
        - $ref: "#/components/schemas/Geometry"
        - properties:
            coordinates:
              type: array
              items:
                type: array
                items:
                  $ref: '#/components/schemas/Point2D'
        
    MultiPoint:
      type: object
      description: GeoJSON Multi Point
      externalDocs:
        url: http://geojson.org/geojson-spec.html#id5
      allOf:
        - $ref: "#/components/schemas/Geometry"
        - properties:
            coordinates:
              type: array
              items:
                $ref: '#/components/schemas/Point2D'
              
    MultiLineString:
      type: object
      description: GeoJSON Multi Line String
      externalDocs:
        url: http://geojson.org/geojson-spec.html#id6
      allOf:
        - $ref: "#/components/schemas/Geometry"   
        - properties:
            coordinates:
              type: array
              items:
                type: array
                items:
                  $ref: '#/components/schemas/Point2D'
        
        
    MultiPolygon:
      type: object
      description: GeoJSON Multi Polygon
      externalDocs:
        url: http://geojson.org/geojson-spec.html#id6
      allOf:
        - $ref: "#/components/schemas/Geometry"
        - properties:
            coordinates:
              type: array
              items:
                type: array
                items:
                  type: array
                  items:
                    $ref: '#/components/schemas/Point2D'



    Categories:
      type: string
      x-uri-prefix: "https://uri.fiware.org/ns/data-models#"
      description: >
            URN holding the id of the attribute
      enum: &CATEGORIES
        - apartments
        - farm
        - hotel
        - house
        - detached
        - residential
        - dormitory
        - terrace
        - houseboat
        - bungalow
        - static_caravan
        - commercial
        - office
        - industrial
        - retail
        - warehouse
        - kiosk
        - bakehouse
        - cathedral
        - chapel
        - church
        - kindergarten
        - mosque
        - temple
        - synagogue
        - shrine
        - civic
        - hospital
        - school
        - stadium
        - train_station
        - transportation
        - university
        - grandstand
        - public
        - barn
        - bridge
        - bunker
        - cabin
        - carport
        - conservatory
        - construction
        - cowshed
        - digester
        - farm_auxiliary
        - garage
        - garages
        - garbage_shed
        - greenhouse
        - hangar
        - hut
        - pavilion
        - parking
        - riding_hall
        - roof
        - shed
        - stable
        - sty
        - transformer_tower
        - service
        - ruins
        - water_tower
        
        
    Address:
    
      x-attr-type: "Property"
      x-model: "https://schema.org/address"
      externalDocs:
        url: https://schema.org/address
    
      description: >
        The mailing address.
      
      type: "object"
      properties:  

        addressCountry:
          type: "string"
          description: >
            The country. For example, USA. You can also provide the two-letter ISO 3166-1 alpha-2 country code.
        addressLocality:
          type: "string"
          description: >
            The locality in which the street address is, and which is in the region. For example, Mountain View.
        addressRegion:
          type: "string"  
          description: >
            The region in which the locality is, and which is in the country. For example, California or another appropriate first-level Administrative division
        postOfficeBoxNumber:
          type: "string"
          description: >
            The post office box number for PO box addresses.
        postalCode:
          type: "string"
          description: >
            The postal code. For example, 94043.
        streetAddress:
          type: "string"  
          description: >
            The street address. For example, 1600 Amphitheatre Pkwy.
      
    Building:
      required:
        - address
        - category
        
      description: >
        ## Description
  
        This entity contains a harmonised description of a Building. This entity is
        associated with the vertical segments of smart homes, smart cities, industry and
        related IoT applications.
        
        This data model has been partially developed in cooperation with mobile
        operators and the [GSMA](https://www.gsma.com/iot/iot-big-data/), compared to
        GSMA data model following changes are introduced:
        
        -   the reference to `BuildingType` is removed, since `BuildingType` compared to
            `category` attribute does not introduce significant information.
        
        -   `category` attribute is required.
        
        -   `openingHours` is introduced following schema.org data model to allow
            fine-grained on building opening times. GSMA supported this as free text in
            the `notes` attribute (removed as well).
        
        -   `refSubscriptionService` is not supported, since `SubscriptionService` model
            is not supported currently.
        
        ## Data Model
        
        For a full description of the following attributes refer to GSMA
        [IoT Big Data Harmonised Data Model](https://github.com/GSMADeveloper/NGSI-LD-Entities)
      
      
      type: "object"
      allOf:
        - $ref: "#/components/schemas/Common"
        - $ref: "#/components/schemas/Movable"
        
      properties:
      
        address:
          $ref: '#/components/schemas/Address'
        
        category:
          x-attr-type: "EnumProperty"
          type: "string"
          enum: *CATEGORIES
          description: >
            The categories that this building belongs to
      
    
        containedInPlace :
          x-attr-type: "Relationship"
          x-model: "https://schema.org/URL"
          type: "string"
          format: "URL"
          description: >
            The URL this building resides within  
       
            
        dataProvider:
          x-attr-type: "Property"
          x-model: "https://schema.org/URL"
          type: "string"
          format: "URL"
          description: >
            Specifies the URL to information about the provider of this information
          

        description:
          $ref: '#/components/schemas/Description'
          
          
        floorsAboveGround:
          x-attr-type: "Property"
          x-model: "https://schema.org/Integer"
          type: "integer"
          format: "int32"
          description: >
            Number of floors above ground within the building


        floorsBelowGround:
          x-attr-type: "Property"
          x-model: "https://schema.org/Integer"
          type: "integer"
          format: "int32"
          description: >
            Number of floors below ground within the building

        occupier:
          x-attr-type: "Relationship"
          x-model: "https://schema.org/URL"
          type: "string"
          format: "URL"
          description: >
            Link to the occupiers of the building

        openingHours :
          x-attr-type: "Property"
          x-model: "https://schema.org/openingHours"
          type: array
          items:
            type: object
            properties:
              type: 
                type: string
              values: 
                type: array
                items:
                  type: string
                  
        owner :
          x-attr-type: "Relationship"
          x-model: "https://schema.org/URL"
          type: "string"
          format: "URL"
          description: >
            The owner of this building
          externalDocs:
            url: "https://schema.org/openingHours"

        refMap :
          x-attr-type: "Property"
          x-model: "https://schema.org/URL"
          type: "string"
          format: "URL"
          description: >
            The URL holding a map of the building
            
        source:
          x-attr-type: "Property"
          x-model: ["https://schema.org/Text", "https://schema.org/URL"]
          type: "string"
          description: >
            A sequence of characters giving the source of the entity data.



          